<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title> | 黄玉才的博客</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="黄玉才的博客" /><meta name="author" content="黄玉才" /><meta property="og:locale" content="en_US" /><meta name="description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><meta property="og:description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><link rel="canonical" href="www.yucaihuang.com/posts/2021-05-15-jvm-classfile-resolve/" /><meta property="og:url" content="www.yucaihuang.com/posts/2021-05-15-jvm-classfile-resolve/" /><meta property="og:site_name" content="黄玉才的博客" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-17T10:02:31+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="黄玉才的博客" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@黄玉才" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"www.yucaihuang.com/posts/2021-05-15-jvm-classfile-resolve/"},"url":"www.yucaihuang.com/posts/2021-05-15-jvm-classfile-resolve/","author":{"@type":"Person","name":"黄玉才"},"description":"A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation.","headline":"黄玉才的博客","dateModified":"2021-05-17T10:02:31+08:00","datePublished":"2021-05-17T10:02:31+08:00","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-176388509-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-176388509-1'); </script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="http://www.yucaihuang.com" alt="avatar"> <img src="/assets/img/daliy/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">黄玉才的博客</a></div><div class="site-subtitle font-italic">把开源的变成自己的，把自己的变成祖传的!</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/KolinHuang" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['yc_huang97','163.com'].join('@'))" > <i class="fas fa-envelope"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span></span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip></h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, May 17, 2021, 10:02 AM +0800" > May 17 <i class="unloaded">2021-05-17T10:02:31+08:00</i> </span> by <span class="author"> 黄玉才</div></div><div class="post-content"><p>近日来在持续整理Java并发相关的知识，并且遇到了一个关于<code class="language-plaintext highlighter-rouge">synchronized</code>关键字的问题。</p><p>说<code class="language-plaintext highlighter-rouge">synchronized</code>有两种用法：</p><ol><li>在代码块上使用：Javac编译器会在这个代码块的字节码指令前后加上MonitorEnter和MonitorExit指令，分别表示进入同步代码块和退出同步代码块。这两条指令都是单操作数指令，操作数需要一个Reference类型的变量，如果我们指定了这个对象，那就获取指定对象的监视器；如果我们没有指定这个对象，那会根据代码块所在方法的类型进行判断，如果是成员方法就获取实例对象的监视器锁，如果是静态方法，那就获取类实例的监视器锁。</li><li>在方法上使用：Javac编译器会在方法表的<code class="language-plaintext highlighter-rouge">access_flag</code>字段上加上<code class="language-plaintext highlighter-rouge">ACC_SYNCHRONIZED</code>标志，标识这个方法是一个需要同步的方法。在代码块上使用，会有<code class="language-plaintext highlighter-rouge">MonitorXX</code>系列的指令来显式地来获取监视器；那么问题来了，在方法上使用只是加了一个标志位，那JVM是如何进一步根据这个标志位获取监视器锁的呢？</li></ol><p>出于好奇，我编写了以下测试类，相当简单的一段代码，添加了一个用<code class="language-plaintext highlighter-rouge">synchronized</code>修饰的方法：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="k">new</span> <span class="nf">Test</span><span class="o">().</span><span class="na">test</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"xxx"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>随后，我将上面的类所在源文件编译成了Class文件。</p><p>为了整体加深对class文件组成结构的理解，我决定对这个Class文件进行一次透彻的解析。</p><p><strong>工具方面</strong>：</p><ol><li><code class="language-plaintext highlighter-rouge">javap</code>，查看解析后的Class文件结构。</li><li><a href="https://github.com/KolinHuang/JVM-in-Go-Style">JVM-In-Go-Style</a>，这是我自己基于Go编写的简易Java虚拟机，我会逐步进行断点调试，把class文件的每个字节都分析清楚。</li></ol><p>编译后产生的class文件内容如下：</p><div class="language-markdown highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre>cafe babe 0000 0034 0026 0a00 0800 1707
0018 0a00 0200 170a 0002 0019 0900 1a00
1b08 001c 0a00 1d00 1e07 001f 0100 063c
696e 6974 3e01 0003 2829 5601 0004 436f
6465 0100 0f4c 696e 654e 756d 6265 7254
6162 6c65 0100 124c 6f63 616c 5661 7269
6162 6c65 5461 626c 6501 0004 7468 6973
0100 064c 5465 7374 3b01 0004 6d61 696e
0100 1628 5b4c 6a61 7661 2f6c 616e 672f
5374 7269 6e67 3b29 5601 0004 6172 6773
0100 135b 4c6a 6176 612f 6c61 6e67 2f53
7472 696e 673b 0100 0474 6573 7401 000a
536f 7572 6365 4669 6c65 0100 0954 6573
742e 6a61 7661 0c00 0900 0a01 0004 5465
7374 0c00 1400 0a07 0020 0c00 2100 2201
0003 7878 7807 0023 0c00 2400 2501 0010
6a61 7661 2f6c 616e 672f 4f62 6a65 6374
0100 106a 6176 612f 6c61 6e67 2f53 7973
7465 6d01 0003 6f75 7401 0015 4c6a 6176
612f 696f 2f50 7269 6e74 5374 7265 616d
3b01 0013 6a61 7661 2f69 6f2f 5072 696e
7453 7472 6561 6d01 0007 7072 696e 746c
6e01 0015 284c 6a61 7661 2f6c 616e 672f
5374 7269 6e67 3b29 5600 2100 0200 0800
0000 0000 0300 0100 0900 0a00 0100 0b00
0000 2f00 0100 0100 0000 052a b700 01b1
0000 0002 000c 0000 0006 0001 0000 0007
000d 0000 000c 0001 0000 0005 000e 000f
0000 0009 0010 0011 0001 000b 0000 0039
0002 0001 0000 000b bb00 0259 b700 03b6
0004 b100 0000 0200 0c00 0000 0a00 0200
0000 0a00 0a00 0b00 0d00 0000 0c00 0100
0000 0b00 1200 1300 0000 2000 1400 0a00
0100 0b00 0000 3700 0200 0100 0000 09b2
0005 1206 b600 07b1 0000 0002 000c 0000
000a 0002 0000 000e 0008 000f 000d 0000
000c 0001 0000 0009 000e 000f 0000 0001
0015 0000 0002 0016 
</pre></table></code></div></div><p>文件内容不多，接下来逐字分析。</p><h2 id="1-魔数">1 魔数</h2><p>打头的4个字节叫做魔数，用于标识这是一个class文件，内容固定为<code class="language-plaintext highlighter-rouge">cafe babe</code>，俗称“咖啡baby”。</p><h2 id="2-版本号">2 版本号</h2><p><code class="language-plaintext highlighter-rouge">0000 0034</code>：随后的4个字节标识此字节码支持的JDK版本号。其中，<code class="language-plaintext highlighter-rouge">0000</code>表示次版本号，<code class="language-plaintext highlighter-rouge">0034</code>表示主版本号为52，Java的版本号是从<strong>45</strong>开始的，JDK 1.1之后的每个JDK大版本发布主版本号向上<strong>加1</strong>（<strong>JDK 1.0～1.1使用了45.0～45.3的版本号</strong>），高版本的JDK能向下兼容以前版本的Class文件，但不能运行以后版本的Class文件。</p><p>次版本号只被短暂使用过，从JDK1.2开始到JDK11为止，次版本号都必须置0。在JDK12开始，次版本号用于标识公测信息，如果class文件的次版本号是<code class="language-plaintext highlighter-rouge">65535</code>，那么这个class文件中带有了一些正式版还未启用的特性。</p><h2 id="3-常量池">3 常量池</h2><p><code class="language-plaintext highlighter-rouge">0026</code>：随后的4个字节标识常量池容量计数，从1开始计数。<code class="language-plaintext highlighter-rouge">0026</code>标识此常量池中有37个条目。之所以要从1开始计数，是因为如果后面某些指向常量池的索引值的数据在特定情况下需要表达“<strong>不引用任何一个常量池项目</strong>”的含义，可以把索引值设置为0来表示。</p><p>常量池的所有条目列举如下：</p><div class="language-markdown highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>0a (tag=10) 00 08(classIndex=8) 0017 (nameAndTypeIndex=23) 
07(tag=7) 0018(nameIndex=24) 
0a(tag=10) 0002(classIndex=2) 0017(nameAndTypeIndex=23)
0a(tag=10) 0002(classIndex=2) 0019(nameAndTypeIndex=25)
09(tag=9)  001a(classIndex=26)001b(nameAndTypeIndex=27)
08(tag=8)  001c(stringIndex=28) 
0a(tag=10) 001d(classIndex=29)001e(nameAndTypeIndex=30)
07(tag=7)  001f(nameIndex=31) 
01(tag=1)  0006(len=6) 3c696e69743e(str=<span class="nt">&lt;init&gt;</span>)
01(tag=1)  0003(len=3) 282956(str=()V)
01(tag=1)  0004(len=4) 436f6465(str=Code)
01(tag=1)  000f(len=15)4c696e654e756d6265725461626c65(str=LineNumberTable)
01(tag=1)  0012(len=18)4c6f63616c5661726961626c655461626c65(str=LocalVariableTable)
01(tag=1)  0004(len=4) 74686973(str=this)
01(tag=1)  0006(len=6) 4c546573743b(str=LTest;)
01(tag=1)  0004(len=4) 6d61696e(str=main)
01(tag=1)  0016(len=22)285b4c6a6176612f6c616e672f537472696e673b2956(str=([Ljava/lang/String;)V)
01(tag=1)  0004(len=4) 61726773(args)
01(tag=1)  0013(len=19)5b4c6a6176612f6c616e672f537472696e673b(str=[Ljava/lang/String;)
01(tag=1)  0004(len=4) 74657374(str=test)
01(tag=1)  000a(len=10)536f7572636546696c65(str=SourceFile)
01(tag=1)  0009(len=9) 546573742e6a617661(str=Test.java)
0c(tag=12) 0009(nameIndex=9) 000a(descriptorIndex=10)
01(tag=1)  0004(len=4) 54657374(str=Test)
0c(tag=12) 0014(nameIndex=20) 000a(descriptorIndex=10)
07(tag=7)  0020(nameIndex=32) 
0c(tag=12) 0021(nameIndex=33) 0022(descripotrIndex=34)
01(tag=1)  0003(len=3) 787878(str=xxx)
07(tag=7)  0023(nameIndex=35)
0c(tag=12) 0024(nameIndex=36) 0025(descriptorIndex=37)
01(tag=1)  0010(len=16)6a6176612f6c616e672f4f626a656374(str=java/lang/Object)
01(tag=1)  0010(len=16)6a6176612f6c616e672f53797374656d(str=java/lang/System)
01(tag=1)  0003(len=3) 6f7574(str=out)
01(tag=1)  0015(len=21) 4c6a6176612f696f2f5072696e7453747265616d3b(str=Ljava/io/PrintStream;)
01(tag=1)  0013(len=19) 6a6176612f696f2f5072696e7453747265616d(str=java/io/PrintStream)
01(tag=1)  0007(len=7)  7072696e746c6e(str=println)
01(tag=1)  0015(len=21) 284c6a6176612f6c616e672f537472696e673b2956(str=(Ljava/lang/String;)V)
</pre></table></code></div></div><p>每个条目都是以1字节的<code class="language-plaintext highlighter-rouge">tag</code>打头，标识这是属于哪种常量，是字面量还是符号引用。后面会跟一个2字节的len标识这个常量有多少字节。<code class="language-plaintext highlighter-rouge">tag</code>的解释如下：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>	<span class="n">CONSTANT_Class</span>              <span class="o">=</span> <span class="mi">7</span>		<span class="c1">//类或接口的符号引用</span>
	<span class="n">CONSTANT_Fieldref</span>           <span class="o">=</span> <span class="mi">9</span>		<span class="c1">//字段的符号引用</span>
	<span class="n">CONSTANT_Methodref</span>          <span class="o">=</span> <span class="mi">10</span>	<span class="c1">//类中方法的符号引用</span>
	<span class="n">CONSTANT_InterfaceMethodref</span> <span class="o">=</span> <span class="mi">11</span>	<span class="c1">//接口中方法的符号引用</span>
	<span class="n">CONSTANT_String</span>             <span class="o">=</span> <span class="mi">8</span>		<span class="c1">//字符串类型字面量</span>
	<span class="n">CONSTANT_Integer</span>            <span class="o">=</span> <span class="mi">3</span>		<span class="c1">//整型字面量</span>
	<span class="n">CONSTANT_Float</span>              <span class="o">=</span> <span class="mi">4</span>		<span class="c1">//浮点型字面量</span>
	<span class="n">CONSTANT_Long</span>               <span class="o">=</span> <span class="mi">5</span>		<span class="c1">//长整型字面量</span>
	<span class="n">CONSTANT_Double</span>             <span class="o">=</span> <span class="mi">6</span>		<span class="c1">//双精度字面量</span>
	<span class="n">CONSTANT_NameAndType</span>        <span class="o">=</span> <span class="mi">12</span>	<span class="c1">//字段或方法的部分符号引用</span>
	<span class="n">CONSTANT_Utf8</span>               <span class="o">=</span> <span class="mi">1</span>		<span class="c1">//UTF-8编码的字符串</span>
	<span class="n">CONSTANT_MethodHandle</span>       <span class="o">=</span> <span class="mi">15</span>	<span class="c1">//表示方法句柄</span>
	<span class="n">CONSTANT_MethodType</span>         <span class="o">=</span> <span class="mi">16</span>	<span class="c1">//表示方法类型</span>
	<span class="n">CONSTANT_InvokeDynamic</span>      <span class="o">=</span> <span class="mi">18</span>	<span class="c1">//表示一个动态方法调用点</span>
</pre></table></code></div></div><h2 id="3-类访问标志">3 类访问标志</h2><p><code class="language-plaintext highlighter-rouge">0021</code>：是类的访问标识，转换为二进制就是<code class="language-plaintext highlighter-rouge">0B0000000000100001</code>，访问标志是用位掩码表示的，此类有2个标志：<code class="language-plaintext highlighter-rouge">ACC_PUBLIC | ACC_SUPER</code>。<code class="language-plaintext highlighter-rouge">ACC_SUPER</code>在JDK1.2以后就强制置1了，标识允许这个类使用<code class="language-plaintext highlighter-rouge">invokespecial</code>指令；<code class="language-plaintext highlighter-rouge">ACC_PUBLIC</code>标识这个类的访问权限是公开的。</p><p>access_flags中一共有16个标志位可以使用，当前只定义了其中9个，没有使用到的标志位要求一律为零。借用深入理解JVM书中的总结：</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://hyc-pic.oss-cn-hangzhou.aliyuncs.com/image-20201218092405687.png" alt="image-20201218092405687" /></p><h2 id="4-类索引父类索引接口索引集合">4 类索引、父类索引、接口索引集合</h2><p><code class="language-plaintext highlighter-rouge">0002</code>表示类索引为2，<code class="language-plaintext highlighter-rouge">0008</code>表示父类索引为8，<code class="language-plaintext highlighter-rouge">0000</code>表示接口集合计数为0，即无接口。这个索引指的是在常量池中的符号引用索引。我们用javap可以明显看出，索引为2的位置是<code class="language-plaintext highlighter-rouge">Test</code>，索引为8的位置是<code class="language-plaintext highlighter-rouge">java/lang/Object</code>。</p><h2 id="5-字段表">5 字段表</h2><p><code class="language-plaintext highlighter-rouge">0000</code>：接下来的2个字节标识字段表的长度，这里因为没有定义任何字段，所以为0。</p><h2 id="6-方法表">6 方法表</h2><p><code class="language-plaintext highlighter-rouge">0003</code>：表示方法的计数，有三个方法，分别是<code class="language-plaintext highlighter-rouge">&lt;init&gt;</code>, <code class="language-plaintext highlighter-rouge">main</code>和<code class="language-plaintext highlighter-rouge">test</code>。每个方法都可以视为一张表，打头的仍旧是<code class="language-plaintext highlighter-rouge">access_flag</code>字段，用于访问标识，这里可以印证开头说的，<code class="language-plaintext highlighter-rouge">synchronized</code>关键字使用在方法上，会在这个字段中标注<code class="language-plaintext highlighter-rouge">ACC_SYNCHRONIZED</code>，定位在下表的第64行。</p><p>每个方法中还有属性表，方法比较重要的属性有：<code class="language-plaintext highlighter-rouge">LineNumberTable</code>和<code class="language-plaintext highlighter-rouge">LocalVariableTable</code>。<code class="language-plaintext highlighter-rouge">LineNumberTable</code>是字节码指令行号与Java代码行号的对应；<code class="language-plaintext highlighter-rouge">LocalVariableTable</code>就是是我们熟知的局部变量表。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
</pre><td class="rouge-code"><pre><span class="c1">//starting read methods</span>
<span class="c1">//method 1</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">accessFlags</span><span class="o">=</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="no">ACC_PUBLIC</span><span class="o">)</span>
<span class="mo">000</span><span class="mi">9</span><span class="o">(</span><span class="n">nameIndex</span><span class="o">=</span><span class="mi">9</span><span class="o">)</span>
<span class="mo">000</span><span class="n">a</span><span class="o">(</span><span class="n">describetorIndex</span><span class="o">=</span><span class="mi">10</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">attributesCount</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">000</span><span class="n">b</span><span class="o">(</span><span class="n">attributeNameIndex</span><span class="o">=</span><span class="mi">11</span><span class="o">,</span> <span class="n">attributeName</span><span class="o">=</span><span class="nc">Code</span><span class="o">,</span> <span class="k">this</span> <span class="n">is</span> <span class="n">a</span> <span class="err">'</span><span class="nc">Code</span><span class="err">'</span> <span class="n">attribute</span><span class="o">)</span>
<span class="mo">0000002</span><span class="n">f</span><span class="o">(</span><span class="n">attributeLen</span><span class="o">=</span><span class="mi">47</span><span class="o">)</span>
<span class="c1">//-starting read the 'Code' attribute of method1 </span>
<span class="mo">0001</span><span class="o">(</span><span class="n">maxStack</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">maxLocalVariable</span><span class="o">)</span>
<span class="mo">00000005</span><span class="o">(</span><span class="n">codeLen</span><span class="o">=</span><span class="mi">5</span><span class="o">)</span>
<span class="mi">2</span><span class="n">ab70001b1</span><span class="o">(</span><span class="n">code</span><span class="o">=*</span><span class="err">�</span><span class="o">)</span>
<span class="c1">//--starting read ExceptionTable of 'Code'</span>
<span class="mo">0000</span><span class="o">(</span><span class="nc">ExceptionTableLen</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="c1">//--starting read attributes of 'Code'</span>
<span class="mo">0002</span><span class="o">(</span><span class="n">attributesCount</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
<span class="c1">//---the first attribute of attributes</span>
<span class="mo">000</span><span class="n">c</span><span class="o">(</span><span class="n">attributeNameIndex</span><span class="o">=</span><span class="mi">12</span> <span class="o">-&gt;</span> <span class="nc">LineNumberTable</span><span class="o">)</span>
<span class="mo">00000006</span><span class="o">(</span><span class="n">attributeLen</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">lineNumberTableLen</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">startPC</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="mo">0007</span><span class="o">(</span><span class="n">lineNumber</span><span class="o">=</span><span class="mi">7</span><span class="o">)</span>
<span class="mo">000</span><span class="n">d</span><span class="o">(</span><span class="n">attributeNameIndex</span><span class="o">=</span><span class="mi">13</span> <span class="o">-&gt;</span> <span class="nc">LocalVariableTable</span><span class="o">)</span>
<span class="mo">0000000</span><span class="n">c</span><span class="o">(</span><span class="n">attributeLen</span><span class="o">=</span><span class="mi">12</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">localVariableTableLen</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">startPC</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="mo">0005</span><span class="o">(</span><span class="n">len</span><span class="o">=</span><span class="mi">5</span><span class="o">)</span>
<span class="mo">000</span><span class="n">e</span><span class="o">(</span><span class="n">nameIndex</span><span class="o">=</span><span class="mi">14</span><span class="o">)</span>
<span class="mo">000</span><span class="n">f</span><span class="o">(</span><span class="n">descriptorIndex</span><span class="o">=</span><span class="mi">15</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>

<span class="c1">//starting read method2</span>
<span class="mo">000</span><span class="mi">9</span><span class="o">(</span><span class="n">accessFlags</span><span class="o">=</span><span class="mi">9</span><span class="o">=</span><span class="mb">0B0000000000001001</span> <span class="o">-&gt;</span> <span class="no">ACC_PUBLIC</span> <span class="o">|</span> <span class="no">ACC_STATIC</span><span class="o">)</span>
<span class="mo">0010</span><span class="o">(</span><span class="n">nameIndex</span><span class="o">=</span><span class="mi">16</span><span class="o">)</span>
<span class="mo">0011</span><span class="o">(</span><span class="n">descriptor</span><span class="o">=</span><span class="mi">17</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">attributesCount</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">000</span><span class="n">b</span><span class="o">(</span><span class="n">attributeNameIndex</span><span class="o">=</span><span class="mi">11</span> <span class="o">-&gt;</span> <span class="nc">Code</span><span class="o">)</span>
<span class="mo">0000003</span><span class="mi">9</span><span class="o">(</span><span class="n">attributeLen</span><span class="o">=</span><span class="mi">57</span><span class="o">)</span>
<span class="mo">0002</span><span class="o">(</span><span class="n">maxStack</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">maxLocal</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">0000000</span><span class="n">b</span><span class="o">(</span><span class="n">codeLen</span><span class="o">=</span><span class="mi">11</span><span class="o">)</span>
<span class="n">bb000259b70003b60004b1</span><span class="o">(</span><span class="err">�</span><span class="no">Y</span><span class="err">��</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">exceptionTableLen</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="mo">0002</span><span class="o">(</span><span class="n">attributesCount</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
<span class="mo">000</span><span class="n">c</span><span class="o">(</span><span class="n">attributeNameIndex</span><span class="o">=</span><span class="mi">12</span> <span class="o">-&gt;</span> <span class="nc">LineNumberTable</span><span class="o">)</span>
<span class="mo">0000000</span><span class="n">a</span><span class="o">(</span><span class="n">attributeLen</span><span class="o">=</span><span class="mi">10</span><span class="o">)</span>
<span class="mo">0002</span><span class="o">(</span><span class="n">lineNumberTableLen</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">startPC</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="mo">000</span><span class="n">a</span><span class="o">(</span><span class="n">lineNumber</span><span class="o">=</span><span class="mi">10</span><span class="o">)</span>
<span class="mo">000</span><span class="n">a</span><span class="o">(</span><span class="n">startPC</span><span class="o">=</span><span class="mi">10</span><span class="o">)</span>
<span class="mo">000</span><span class="n">b</span><span class="o">(</span><span class="n">lineNumber</span><span class="o">=</span><span class="mi">11</span><span class="o">)</span>
<span class="mo">000</span><span class="n">d</span><span class="o">(</span><span class="n">attributeNameIndex</span><span class="o">=</span><span class="mi">13</span> <span class="o">-&gt;</span> <span class="nc">LocalVariableTable</span><span class="o">)</span>
<span class="mo">0000000</span><span class="n">c</span><span class="o">(</span><span class="n">attributeLen</span><span class="o">=</span><span class="mi">12</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">localVariableTableLen</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">startPC</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="mo">000</span><span class="n">b</span><span class="o">(</span><span class="n">length</span><span class="o">=</span><span class="mi">11</span><span class="o">)</span>
<span class="mo">0012</span><span class="o">(</span><span class="n">nameIndex</span><span class="o">=</span><span class="mi">18</span><span class="o">)</span>
<span class="mo">0013</span><span class="o">(</span><span class="n">descriptorIndex</span><span class="o">=</span><span class="mi">19</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">index</span><span class="o">)</span>


<span class="c1">//starting read method3</span>
<span class="mo">0020</span><span class="o">(</span><span class="n">accessFlags</span><span class="o">=</span><span class="mi">32</span><span class="o">=</span><span class="mb">0B0000000000100000</span> <span class="o">-&gt;</span> <span class="no">ACC_SYNCHRONIZED</span><span class="o">)</span>
<span class="mo">0014</span><span class="o">(</span><span class="n">nameIndex</span><span class="o">=</span><span class="mi">20</span><span class="o">)</span>
<span class="mo">000</span><span class="n">a</span><span class="o">(</span><span class="n">descriptor</span><span class="o">=</span><span class="mi">10</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">attributeCount</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">000</span><span class="n">b</span><span class="o">(</span><span class="n">attributeNameIndex</span><span class="o">=</span><span class="mi">11</span> <span class="o">-&gt;</span> <span class="nc">Code</span><span class="o">)</span>
<span class="mo">00000037</span><span class="o">(</span><span class="n">attributeLen</span><span class="o">=</span><span class="mi">55</span><span class="o">)</span>
<span class="mo">0002</span><span class="o">(</span><span class="n">maxStack</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">maxLocal</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">0000000</span><span class="mi">9</span><span class="o">(</span><span class="n">codeLen</span><span class="o">=</span><span class="mi">9</span><span class="o">)</span>
<span class="n">b200051206b60007b1</span><span class="o">(</span><span class="err">�</span> <span class="err">��</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">exceptionTableLen</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="mo">0002</span><span class="o">(</span><span class="n">attributeCount</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
<span class="mo">000</span><span class="n">c</span><span class="o">(</span><span class="n">attributenameIndex</span><span class="o">=</span><span class="mi">12</span> <span class="o">-&gt;</span> <span class="nc">LineNumberTable</span><span class="o">)</span>
<span class="mo">0000000</span><span class="n">a</span><span class="o">(</span><span class="n">attributeLen</span><span class="o">=</span><span class="mi">10</span><span class="o">)</span>
<span class="mo">0002</span><span class="o">(</span><span class="n">attributesCount</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">startPC</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="mo">000</span><span class="n">e</span><span class="o">(</span><span class="n">lineNumber</span><span class="o">=</span><span class="mi">14</span><span class="o">)</span>
<span class="mo">000</span><span class="mi">8</span><span class="o">(</span><span class="n">startPC</span><span class="o">=</span><span class="mi">8</span><span class="o">)</span>
<span class="mo">000</span><span class="n">f</span><span class="o">(</span><span class="n">lineNumber</span><span class="o">=</span><span class="mi">15</span><span class="o">)</span>
<span class="mo">000</span><span class="n">d</span><span class="o">(</span><span class="n">attributerNameIndex</span><span class="o">=</span><span class="mi">13</span> <span class="o">-&gt;</span> <span class="nc">LocalVariableTalbe</span><span class="o">)</span>
<span class="mo">0000000</span><span class="n">c</span><span class="o">(</span><span class="n">attributelen</span><span class="o">=</span><span class="mi">12</span><span class="o">)</span>
<span class="mo">0001</span><span class="o">(</span><span class="n">localvariableTableLen</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">startPC</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="mo">000</span><span class="mi">9</span><span class="o">(</span><span class="n">len</span><span class="o">=</span><span class="mi">9</span><span class="o">)</span>
<span class="mo">000</span><span class="n">e</span><span class="o">(</span><span class="n">nameIndex</span><span class="o">=</span><span class="mi">14</span><span class="o">)</span>
<span class="mo">000</span><span class="n">f</span><span class="o">(</span><span class="n">descriptorIndex</span><span class="o">=</span><span class="mi">15</span><span class="o">)</span>
<span class="mo">0000</span><span class="o">(</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
</pre></table></code></div></div><h2 id="7-额外属性表">7 额外属性表</h2><p>Class文件、字段表、方法表都可以携带自己的属性表（attribute_info）集合，以描述某些场景专有的信息。方法表集合之后的属性表集合，指的是class文件所携带的辅助信息，比如该class文件的源文件的名称，以及任何带有RetentionPolicy.CLASS或者RetentionPolicy.RUNTIME的注解。这类信息通常被用于Java虚拟机的验证与运行，以及Java程序的调试。</p><h2 id="8-回归正题">8 回归正题</h2><p>回到正题，这个<code class="language-plaintext highlighter-rouge">ACC_SYNCHRONIZED</code>标志到底是在何时被JVM利用的？</p><p>首先在查看<code class="language-plaintext highlighter-rouge">test</code>方法的字节码时，发现Javac编译器并没有在其中添加<code class="language-plaintext highlighter-rouge">monitorXXX</code>系列的虚拟机指令。查阅资料得知，在将这个方法入栈后，会检查方法表的访问标志，如果设置了<code class="language-plaintext highlighter-rouge">ACC_SYNCHRONIZED</code>标志，那么就会隐式地获取监视器锁<code class="language-plaintext highlighter-rouge">ObjectMonitor</code>，然后再执行方法。</p><p>以上的回答我并不满意，于是我去找了OpenJDK，看看源码如何实现的，希望能彻底解惑。</p></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text= - 黄玉才的博客&url=www.yucaihuang.com/posts/2021-05-15-jvm-classfile-resolve/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title= - 黄玉才的博客&u=www.yucaihuang.com/posts/2021-05-15-jvm-classfile-resolve/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text= - 黄玉才的博客&url=www.yucaihuang.com/posts/2021-05-15-jvm-classfile-resolve/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/web-url-with-chinese-string/">URL包含中文，请求资源404</a></li><li><a href="/posts/web-docker_2/">Docker：入门</a></li><li><a href="/posts/web-docker_1/">Docker：概述</a></li><li><a href="/posts/web-delete-system-python-in-centos/">centOS误删系统自带python</a></li><li><a href="/posts/springboot-starter-id/">创建自定义Springboot starter</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E7%AE%97%E6%B3%95%E9%A2%98%E8%A7%A3/">算法题解</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/java%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/">Java源码学习</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/jvm/">jvm</a> <a class="post-tag" href="/tags/algorithms/">Algorithms</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/redis/">redis</a> <a class="post-tag" href="/tags/concurrency/">concurrency</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/java-nio/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > May 13 <i class="unloaded">2021-05-13T15:40:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>浅析Java NIO</h3><div class="text-muted small"><p> 本文用于记录对Java NIO的一些理解和思考 核心类 Java NIO主要有三个核心部分组成： buffer缓冲区 Channel管道 Selector选择器 Buffer类维护了4个核心变量属性来提供关于其所包含的数组的信息。它们是： 容量Capacity 缓冲区能够容纳的数据元素的最大数量。容量在缓冲区...</p></div></div></a></div><div class="card"> <a href="/posts/design-pattern/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > May 6 <i class="unloaded">2021-05-06T18:49:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>设计模式</h3><div class="text-muted small"><p> 设计模式的六大原则 开闭原则：一个软件实体如类、模块和函数应该对修改封闭，对扩展开放。 单一职责原则：一个类只做一件事，一个类应该只有一个引起它修改的原因。 里氏替换原则：子类应该可以完全替换父类。也就是说在使用继承时，只扩展新功能，而不要破坏父类原有的功能。 依赖倒置原则：细节应该依赖于抽象，抽象不应依赖于细节。把抽象放在程序设计的高层，并保持稳定，程序的细节变化由底层...</p></div></div></a></div><div class="card"> <a href="/posts/leetcode-evaluate-notation/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Apr 19 <i class="unloaded">2021-04-19T15:32:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>leetcode：表达式求值总结</h3><div class="text-muted small"><p> 227. 基本计算器 II 给你一个字符串表达式 s ，请你实现一个基本计算器来计算并返回它的值。整数除法仅保留整数部分。运算符只包含+-*/，不包含括号。 用一个变量来保存当前数字的符号，遍历每个字符： 当前字符是数字，就往后取，直到遇到其他字符，就取得了一个完整的数字。 如果当前数字的前一个符号是： +，就将数字入栈 -...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/java-nio/" class="btn btn-outline-primary"><p>浅析Java NIO</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><p class="footer-center"> © 2021 <a href="">Yucai Huang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span> <br> <a href="https://beian.miit.gov.cn/" target="_blank">浙ICP备2020032055号-1</a></p></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/%E7%AE%97%E6%B3%95%E9%A2%98%E8%A7%A3/">算法题解</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/java%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/">Java源码学习</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/jvm/">jvm</a> <a class="post-tag" href="/tags/algorithms/">Algorithms</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/redis/">redis</a> <a class="post-tag" href="/tags/concurrency/">concurrency</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-176388509-1', 'auto'); ga('send', 'pageview'); </script> <script> (function(e,t,n,i,s,a,c){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)} ;a=t.createElement(i);c=t.getElementsByTagName(i)[0];a.async=true;a.src=s ;c.parentNode.insertBefore(a,c) })(window,document,"galite","script","https://cdn.jsdelivr.net/npm/ga-lite@2/dist/ga-lite.min.js"); galite('create', '{"id"=>"UA-176388509-1", "pv"=>{"enabled"=>false, "proxy_url"=>"", "proxy_endpoint"=>"", "cache"=>true}}', 'auto'); galite('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="www.yucaihuang.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
